<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0a0a0a">
    <title>DOOMED2LIVE</title>
    <link href="https://fonts.googleapis.com/css2?family=Overpass+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="glitch.css">
    <link rel="icon" type="image/png" href="doomed2livefavicon.png">

    <!-- Apple devices (iOS, macOS) -->
    <link rel="apple-touch-icon" href="doomed2livefavicon.png">

    <!-- Windows tiles -->
    <meta name="msapplication-TileImage" content="doomed2livefavicon.png">
    <meta name="msapplication-TileColor" content="#0a0a0a">

    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="logo">ROCHÉ</div>

    <div class="container" id="homeView">
        <div class="home-splash" id="homeSplash" aria-hidden="false">
            <div class="home-splash-text">Welcome to the void</div>
        </div>
        <div class="doors-container" id="doorsContainer" style="display: none;">
            <button class="door-card" onclick="enterVoid(this)" data-reply="You don't have to face it alone." data-track="Doomed to Live">The system is
                rigged</button>
            <button class="door-card" onclick="enterVoid(this)" data-reply="Then let me hold the weight for a second." data-track="If Only">I
                feel powerless</button>
            <button class="door-card" onclick="enterVoid(this)" data-reply="Great minds think alike" data-track="Why Do Fools Fall In Love">Love is not real</button>
            <button class="door-card" onclick="enterVoid(this)" data-reply="You are not alone" data-track="Mayday">I just want to disappear</button>
            <button class="door-card" onclick="enterVoid(this)" data-reply="Let me try to soften the crash" data-track="End Like This">There
                are no happy endings</button>
        </div>
    </div>

    <!-- Interstitial Overlay -->
    <div id="voidOverlay" class="void-overlay" aria-hidden="true">
        <div class="void-text">You are not alone</div>
    </div>

    <div class="music-view" id="musicView">
        <div id="ep"></div> <!-- Anchor Target -->
        <audio id="audioPlayer"></audio>
        <button class="back-button" onclick="goHome()">&larr; Back</button>

        <div class="music-content">
            <div class="content-columns">
                <div class="release-info">
                    <div class="release-header">
                        <div class="ep-artwork">
                            <img src="doomedtolivecoverart.webp" alt="Doomed to Live EP Cover">
                        </div>
                    </div>
                </div>

                <div class="tracks-area">
                    <div class="track-list" id="trackList"></div>
                    <!-- Hidden Player Template that will be moved around -->
                    <div id="playerTemplate" style="display: none;">
                        <div class="player" id="player">
                            <div class="player-title">Now Playing</div>
                            <div class="player-track" id="playerTrack">&mdash;</div>
                            <!-- Audio element moved to root -->
                            <div class="player-controls">
                                <button id="playBtn" onclick="togglePlay(event)">&#9654; Play</button>
                                <button class="download-btn" onclick="downloadTrack(event)">&#9749; Support &
                                    Download</button>
                            </div>
                            <div class="player-progress" onclick="seek(event)">
                                <div class="player-progress-fill" id="progressFill"></div>
                            </div>
                            <div class="player-time">
                                <span id="currentTime">0:00</span>
                                <span id="duration">3:00</span>
                            </div>
                        </div>
                    </div>
                    <!-- Download Full EP Button Moved Here -->
                    <div
                        style="width: 100%; display: flex; justify-content: center; margin-top: 24px; padding-left: 0;">
                        <button class="download-full-ep-btn" onclick="downloadFullEP()">Download Full EP</button>
                    </div>
                </div>
            </div>

            <!-- Lyrics Container Inside music-content -->
            <div id="lyricsContainer" class="lyrics-container">
                <div id="currentLyricLine" class="lyrics-line"></div>
            </div>
        </div>
    </div>

    <!-- Older Music Section (Outside the 2-column layout) -->
    <!-- Temporarily Deactivated
        <div class="older-music-section">
            <button class="older-music-btn" onclick="goToArchive()">PAST MOODS</button>
        </div>
        -->
    </div>

    <!-- Archive View (Reusing layout structure) -->
    <!-- Temporarily Deactivated
    <div class="music-view" id="archiveView">
        <button class="back-button" onclick="returnToLatest()">&larr; Latest</button>

        <div class="music-content">
            <div class="tracks-area">
                <div class="track-list" id="archiveList">
                    Populated by JS
                </div>
            </div>
        </div>
    </div>
    -->

    <!-- Mini Player (appears above footer when playing) -->
    <!-- Mini Player (appears above footer when playing) -->
    <!-- Discreet Player Info (Bottom Right) -->
    <div class="discreet-player-info" id="discreetPlayer">
        <div class="discreet-status"></div>
        <div class="discreet-text">
            <span id="discreetTrackName" style="margin-right: 8px;">Doomed to Live</span>
            <span id="discreetTime" style="color: var(--color-text-secondary); font-size: 9px;">0:00 / 0:00</span>
        </div>
        <div class="discreet-controls">
            <input type="range" id="volumeSlider" class="volume-slider" min="0" max="1" step="0.05" value="1"
                oninput="setVolume(this.value)">
            <button class="discreet-btn" id="discreetPlayBtn" onclick="togglePlay()">&#9654;</button>
        </div>
    </div>

    <footer class="site-footer" id="siteFooter">
    <!-- Progress Bar Integrated into Footer Top Border -->
    <div class="footer-progress-container" id="footerProgressContainer" onclick="seekFooter(event)">
        <div class="footer-progress-bar" id="footerProgressBar"></div>
    </div>

    <div class="footer-row">
        <button type="button" class="support-link" id="supportNowBtn">Need support right now?</button>

        <nav class="socials socials--icons" aria-label="Social links">
            <a href="https://instagram.com/@rocheofficiel" class="social-icon-link" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path d="M7.5 2h9A5.5 5.5 0 0 1 22 7.5v9A5.5 5.5 0 0 1 16.5 22h-9A5.5 5.5 0 0 1 2 16.5v-9A5.5 5.5 0 0 1 7.5 2Zm0 2A3.5 3.5 0 0 0 4 7.5v9A3.5 3.5 0 0 0 7.5 20h9a3.5 3.5 0 0 0 3.5-3.5v-9A3.5 3.5 0 0 0 16.5 4h-9ZM12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6Zm5.75-2.25a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Z" />
                </svg>
                <span class="sr-only">Instagram</span>
            </a>
            <a href="https://youtube.com/@rocheofficiel" class="social-icon-link" target="_blank" rel="noopener noreferrer" aria-label="YouTube">
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path d="M21.7 8.02a3 3 0 0 0-2.11-2.12C17.7 5.4 12 5.4 12 5.4s-5.7 0-7.59.5A3 3 0 0 0 2.3 8.02 31.1 31.1 0 0 0 1.8 12c0 1.31.17 2.63.5 3.98a3 3 0 0 0 2.11 2.12c1.89.5 7.59.5 7.59.5s5.7 0 7.59-.5a3 3 0 0 0 2.11-2.12c.33-1.35.5-2.67.5-3.98s-.17-2.63-.5-3.98ZM10 15.2V8.8L15.6 12 10 15.2Z" />
                </svg>
                <span class="sr-only">YouTube</span>
            </a>
            <a href="https://tiktok.com/@rocheofficiel" class="social-icon-link" target="_blank" rel="noopener noreferrer" aria-label="TikTok">
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path d="M14 2h2c.24 2.06 1.63 3.67 3.7 4.02v2.04c-1.44-.04-2.78-.52-3.86-1.32v7.86a6.58 6.58 0 1 1-6.58-6.58c.28 0 .56.02.83.06v2.22a3.96 3.96 0 1 0 2.39 3.64V2Z" />
                </svg>
                <span class="sr-only">TikTok</span>
            </a>
        </nav>
    </div>
</footer>

<!-- Support Modal -->
<div class="modal support-modal" id="supportModal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="supportModalTitle" aria-describedby="supportModalDesc">
    <div class="modal-content support-modal-content" role="document" tabindex="-1">
        <button class="modal-close" type="button" id="supportModalClose" aria-label="Close">&times;</button>
        <div class="support-finder">
            <div class="support-finder-header">
                <h3 id="supportModalTitle">Need support right now?</h3>
                <p id="supportModalDesc">If you're in immediate danger, call your local emergency number.</p>
            </div>

            <div class="support-finder-content">
                <div class="support-region-row">
                    <label for="supportRegionSelect">Region</label>
                    <select id="supportRegionSelect" name="region">
                        <option value="us">United States</option>
                        <option value="ca">Canada</option>
                        <option value="uk">United Kingdom</option>
                        <option value="roi">Republic of Ireland</option>
                        <option value="au">Australia</option>
                        <option value="int">International</option>
                    </select>
                </div>

                <div class="support-region-info" id="supportRegionInfo"></div>

                <div class="support-hotline-section">
                    <h4 class="support-section-title">Available support services</h4>
                    <div class="support-hotline-list" id="supportHotlineList"></div>
                </div>

                <div class="support-emergency-banner">
                    In immediate danger? Call your local emergency number.
                </div>

                <p class="support-worldwide">
                    <a href="https://findahelpline.com/" target="_blank" rel="noopener noreferrer">Find help worldwide</a>
                </p>
            </div>
        </div>
    </div>
</div>

    <!-- Sympathy Modal (First Interaction) -->
<div class="modal" id="sympathyModal">
    <div class="modal-content" style="text-align: center;">
        <button class="modal-close" onclick="closeModal('sympathyModal')">&times;</button>
        <h3 style="margin-bottom: 24px; font-size: 20px;">DOWNLOAD</h3>
        <p style="font-size: 14px; line-height: 1.6; margin-bottom: 24px;">
            Free path: instant download. Support path: £1+ if you can.
        </p>
        <div style="display: flex; flex-direction: column; gap: 12px;">
            <button class="submit-btn" onclick="startFreeDownload()">Just Download</button>
            <button class="submit-btn" onclick="openPaymentModal()">I'll Support</button>
        </div>
    </div>
</div>

<!-- Post-download Overlay (email optional + identity question) -->
<div class="modal" id="postDownloadModal">
    <div class="modal-content" style="text-align: left;">
        <button class="modal-close" onclick="closeModal('postDownloadModal')" aria-label="Close">&times;</button>
        <h3 style="margin-bottom: 12px;">Want updates when I drop new work?</h3>
        <p style="font-size: 13px; line-height: 1.6; color: var(--color-text-secondary); margin-top: 0;">
            Email is optional. No spam. Just the next release.
        </p>

        <div id="postDownloadDownload" style="display: none; margin-bottom: 18px;">
            <p style="font-size: 13px; line-height: 1.6; color: var(--color-text-secondary); margin: 0 0 10px 0;">
                Thanks <3 — I hope I can ease whatever pain your feeling.
            </p>
            <button type="button" class="submit-btn" id="postDownloadDownloadBtn" onclick="downloadPending()">Download</button>
        </div>

        <form id="postDownloadEmailForm" onsubmit="submitPostDownloadEmail(event)">
            <div class="form-group">
                <label for="postDownloadEmail">Email (optional)</label>
                <input type="email" id="postDownloadEmail" placeholder="you@somewhere.com">
            </div>
            <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                <button type="submit" class="submit-btn">Get updates</button>
                <button type="button" class="submit-btn" style="background: transparent; border: 1px solid var(--color-text-secondary); color: var(--color-text-secondary);" onclick="skipPostDownloadEmail()">Skip</button>
            </div>
            <div id="postDownloadEmailStatus" role="status" aria-live="polite" style="margin-top: 10px; font-size: 12px; color: var(--color-text-secondary);"></div>
        </form>

        <div id="postDownloadIdentity" style="margin-top: 24px;">
            <h3 style="margin-bottom: 12px;">What brought you here?</h3>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button type="button" class="amount-option-btn" onclick="answerIdentity('music')">the music</button>
                <button type="button" class="amount-option-btn" onclick="answerIdentity('story')">the story</button>
                <button type="button" class="amount-option-btn" onclick="answerIdentity('someone')">someone sent it</button>
                <button type="button" class="amount-option-btn" onclick="answerIdentity('accident')">an accident</button>
            </div>
        </div>
    </div>
</div>

    <!-- Payment Input Modal -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('paymentModal')">&times;</button>
            <button class="back-link" onclick="backToSympathy()"
                style="border: none; background: none; color: var(--color-text-secondary); cursor: pointer; margin-bottom: 16px; padding: 0;">&larr; Back</button>
            <h3>Toss a Penny</h3>
            <p id="paymentDescription">Select your contribution amount.</p>

            <div class="form-group">
                <label>Amount (Â£)</label>
                <div style="display: flex; gap: 16px; margin-bottom: 16px;">
                    <button class="amount-option-btn active" onclick="setPaymentAmount('min')">Minimum</button>
                    <button class="amount-option-btn" onclick="setPaymentAmount('custom')">Custom</button>
                </div>
                <input type="number" id="paymentAmountInput" placeholder="Enter amount" step="0.01">
                <p id="minAmountMsg" style="font-size: 10px; color: var(--color-accent); margin-top: 4px;">Minimum:
                    Â£1.00
                </p>
            </div>

            <button class="submit-btn" onclick="initiateStripeCheckout()">Proceed to Checkout</button>
        </div>
    </div>

    <!-- Contact Form Modal (Free MP3) -->
    <div class="modal" id="contactModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('contactModal')">&times;</button>
            <button class="back-link" onclick="backToSympathy()"
                style="border: none; background: none; color: var(--color-text-secondary); cursor: pointer; margin-bottom: 16px; padding: 0;">&larr; Back</button>
            <h3>Fortune Hasn't Favored?</h3>
            <p>No worries. Just let me know who's listening.</p>

            <form id="freeDownloadForm" onsubmit="submitFreeForm(event)">
                <div class="form-group">
                    <label for="freeName">Name *</label>
                    <input type="text" id="freeName" required>
                </div>
                <div class="form-group">
                    <label for="freeEmail">Email *</label>
                    <input type="email" id="freeEmail" required>
                </div>
                <div class="form-group">
                    <label for="freePhone">Phone (Optional)</label>
                    <input type="tel" id="freePhone">
                </div>
                <button type="submit" class="submit-btn" style="background: var(--color-text-secondary);">Get
                    MP3s</button>
            </form>
        </div>
    </div>

    <!-- Stripe Checkout Modal -->
    <div class="modal" id="checkoutModal">
        <div class="modal-content" style="max-width: 800px; width: 95%;">
            <button class="modal-close" onclick="closeModal('checkoutModal')">&times;</button>
            <div id="stripe-checkout-container"></div>
        </div>
    </div>

    <script src="https://js.stripe.com/v3/"></script>
    <div id="toast-container"
        style="position: fixed; bottom: 20px; right: 20px; z-index: 10000; display: flex; flex-direction: column; gap: 10px; pointer-events: none;">
    </div>

    <script src="script.js" defer></script>
</body>

</html>
